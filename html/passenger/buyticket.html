<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <!-- axios -->
    <script src="https://cdn.jsdelivr.net/npm/axios/dist/axios.min.js"></script>

    <!-- sweet alert -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.3/dist/sweetalert2.min.css">
    <script src="https://cdn.jsdelivr.net/npm/sweetalert2@10.16.3/dist/sweetalert2.all.min.js"></script>

    <!-- jquery -->
    <script src="https://code.jquery.com/jquery-3.6.4.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.0/jquery.js"
    integrity="sha512-8Z5++K1rB3U+USaLKG6oO8uWWBhdYsM3hmdirnOEWp8h2B1aOikj5zBzlXs8QOrvY9OxEnD2QDkbSKKpfqcIWw=="
    crossorigin="anonymous"></script>

    <!-- charts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.6.0/chart.min.js" integrity="sha512-GMGzUEevhWh8Tc/njS0bDpwgxdCJLQBWG3Z2Ct+JGOpVnEmjvNx6ts4v6A2XJf1HOrtOsfhv3hBKpK9kE5z8AQ==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>
    <script type="module" src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.11.0/dist/chart.min.mjs"></script>
    
    <!-- icons -->
    <script src="https://unpkg.com/@phosphor-icons/web"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.1.0/css/all.min.css">

    <script src="/js/script.js"></script>
    <script src="/js/auth.js"></script>
    <link rel="stylesheet" href="/css/home.css">
    <link rel="stylesheet" href="/css/style.css">
    <link rel="stylesheet" href="/css/buyticket.css">  
	<script src="/js/buyticket.js" defer></script>
    
    <title>Buy E-Ticket</title>
</head>
<body> 
    <nav class="navbar" >
        <script>createNavBar("passenger")</script>
    </nav>
    

	<div class="train-container">
         
        <div style="position: relative;">
            <div class="train-left">
                <img src="../../Images/t33.png" alt="Train Image" class="train-image">
            </div>
            <div class="sidebar active" style="position: absolute; top: 0; margin-top: 77px;">
                <script>createSideBar("passenger")</script>
            </div>
        </div>
        
		<div class="train-right">
		    <div class="train-form">
							
				<form onsubmit="return false">
					<h2 class="add-train-heading" id="add_update-schedule-header">Buy E-Ticket </h2>

                    <label for="start-station"></label>
                    <!-- <select id="start-station" onchange="validateStation(); getPrice();" name="start-station" required>
                        <option value="" disabled selected>Start Station:</option>
                        <option value="Beliaththa" style="color: #484848">Beliaththa</option>
                        <option value="Colombo Fort" style="color: #484848">Colombo Fort</option>
                        <option value="Panadura" style="color: #484848">Panadura</option>
                    </select> -->
                  
					<div class="wrapper" font-size="1px" id="from">
                        <div class="select-btn">
                            <span>Start Station:</span> 
                            <i font-size="3px" class="fa fa-angle-down"></i>
                        </div>
                        <div class="content">
                            <div class="search">
                                <i class="fas fa-search"></i>
                                <input spellcheck="false" type="text" placeholder="Search">
                            </div>
                            <ul onclick="getPrice(); validateStation(); getPriceList();" class="options"></ul>
                        </div>
                    </div>
                
                    <!-- <label for="end-station"></label>

                    <select id="end-station" onchange="validateStation(); getPrice();" name="end-station" required>
                        <option value="" disabled selected>End Station:</option>
                        <option value="Beliaththa" style="color: #484848">Beliaththa</option>
                        <option value="Colombo Fort" style="color: #484848">Colombo Fort</option>
                        <option value="Panadura" style="color: #484848">Panadura</option>
                    </select><br /> -->
                    <div class="wrapper" font-size="1px" id="to">
                      <div class="select-btn">
                          <span>End Station:</span> 
                          <i font-size="3px" class="fa fa-angle-down"></i>
                      </div>
                      <div class="content">
                          <div class="search">
                              <i class="fas fa-search"></i>
                              <input spellcheck="false" type="text" placeholder="Search">
                          </div>
                          <ul onclick="getPrice(); validateStation(); getPriceList();" class="options"></ul>
                      </div>
                  </div>
                    <span id="station-error"></span>
                    <div class="price-list">
                        </br><span id="price-of-first"></span>
                        </br><span id="price-of-second"></span>
                        </br><span id="price-of-third"></span>
                    </div>

								
                    <label for="date"></label>
                    <input type="date" id="date" name="date" placeholder="Date:" min="" max="" required><br />   
                                
                    <script>
                        var currentDate = new Date();
                        var formattedDate = currentDate.toISOString().split('T')[0];
                        document.getElementById('date').value = formattedDate;
                        var minDate = currentDate.toLocaleDateString('en-CA',{timeZone:'Asia/Colombo'});
                        document.getElementById('date').min = minDate;
                        currentDate.setMonth(currentDate.getMonth() + 3);
                        currentDate.setHours(0, 0, 0, 0);
                        var maxDate = currentDate.toISOString().split('T')[0];
                        document.getElementById('date').max = maxDate;
                    </script>

                    <label for="class"></label>
                    <select id="class" name="class" onchange="getPrice()" required>
                        <option value="" disabled selected>Class:</option>
                        <option value="1st Class" style="color: #484848">1st Class</option>
                        <option value="2nd Class" style="color: #484848">2nd Class</option>
                        <option value="3rd Class" style="color: #484848">3rd Class</option>
                    </select>

                    <label for="no-of-tickets"></label>
					<input type="text" id="no-of-tickets" name="no-of-tickets" onkeyup="validateNoOfTicket(); getPrice();" placeholder=" No. of Tickets:" required><br>
                    <span id="error"></span><br>

                    <div class="price-of-1"> <span id="price-of-one"></span></div>
                    <label for="total-price"></label>
					<input disabled value="" type="Double" id="total-price" name="total-price" placeholder=" Total Price:" ><br>

                    <form method="post" action="https://sandbox.payhere.lk/pay/checkout">   
                        <input type="hidden" name="merchant_id" value="1226549">    <!-- Replace your Merchant ID -->
                        <input type="hidden" name="return_url" value="http://sample.com/return">
                        <input type="hidden" name="cancel_url" value="http://sample.com/cancel">
                        <input type="hidden" name="notify_url" value="http://sample.com/notify">  
                        <br><br>Item Details<br>
                        <input type="text" name="order_id" value="ItemNo12345">
                        <input type="text" name="items" value="Door bell wireless"><br>
                        <input type="text" name="currency" value="LKR">
                        <input type="text" name="recurrence" value="1 Month">
                        <input type="text" name="duration" value="Forever">
                        <input type="text" name="amount" value="1000">  
                        <br><br>Customer Details<br>
                        <input type="text" name="first_name" value="Saman">
                        <input type="text" name="last_name" value="Perera"><br>
                        <input type="text" name="email" value="samanp@gmail.com">
                        <input type="text" name="phone" value="0771234567"><br>
                        <input type="text" name="address" value="No.1, Galle Road">
                        <input type="text" name="city" value="Colombo">
                        <input type="hidden" name="country" value="Sri Lanka">
                        <input type="hidden" name="hash" value="<%= HashCodeGenerator.generatecode("ItemNo12345),1000,">     <!-- Replace with generated hash -->
                        <input type="submit" value="Buy Now">   
                    </form>


					<button class="form-button" id="buy-ticket-button" onclick="buyETicket()">Buy</button>
				</form>
	    	</div>
				
		</div>
	</div>

<script src="/js/stations.js">
</script>
				
</body>